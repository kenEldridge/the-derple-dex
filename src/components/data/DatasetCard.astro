---
interface Props {
  name: string;
  description: string;
  type: 'ohlcv' | 'rss' | 'fred';
  recordCount: number;
  lastUpdated: string;
  href: string;
}

const { name, description, type, recordCount, lastUpdated, href } = Astro.props;

// Format the date
const updated = new Date(lastUpdated);
const formattedDate = updated.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
});

// Type badge
const typeLabels: Record<string, string> = {
  ohlcv: 'Price Data',
  fred: 'Economic Data',
  rss: 'News Feed'
};
const typeLabel = typeLabels[type] || type;
const typeClass = `type-${type}`;
---

<a href={href} class="dataset-card">
  <div class="card-header">
    <h3>{name}</h3>
    <span class={`type-badge ${typeClass}`}>{typeLabel}</span>
  </div>
  <p class="description">{description}</p>
  <div class="card-footer">
    <span class="stat">
      <strong>{recordCount.toLocaleString()}</strong> records
    </span>
    <span class="date">Updated {formattedDate}</span>
  </div>
</a>

<style>
  .dataset-card {
    display: block;
    padding: 1.5rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    text-decoration: none;
    color: inherit;
    transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
    background: var(--bg-secondary);
  }

  .dataset-card:hover {
    transform: translateY(-2px);
    border-color: var(--accent);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 0.75rem;
  }

  h3 {
    margin: 0;
    font-size: 1.25rem;
    color: var(--text-heading);
    font-family: monospace;
  }

  .type-badge {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    white-space: nowrap;
  }

  .type-ohlcv {
    background: rgba(34, 197, 94, 0.2);
    color: #22c55e;
  }

  .type-rss {
    background: rgba(59, 130, 246, 0.2);
    color: #3b82f6;
  }

  .type-fred {
    background: rgba(168, 85, 247, 0.2);
    color: #a855f7;
  }

  .description {
    margin: 0 0 1rem 0;
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.4;
  }

  .card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.85rem;
    color: var(--text-secondary);
  }

  .stat strong {
    color: var(--text-primary);
  }

  .date {
    opacity: 0.8;
  }
</style>
